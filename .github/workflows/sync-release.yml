name: Sync Release to Public Repo

on:
  release:
    types: [published]

jobs:
  sync-release:
    runs-on: ubuntu-latest
    steps:
      - name: Download release assets
        uses: robinraju/release-downloader@v1
        with:
          repository: analyticendeavors/pbi-multi-tool-source
          tag: ${{ github.event.release.tag_name }}
          fileName: "*"
          out-file-path: "assets"
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Create release on public repo
        uses: softprops/action-gh-release@v2
        with:
          repository: analyticendeavors/pbi-multi-tool
          tag_name: ${{ github.event.release.tag_name }}
          name: ${{ github.event.release.name }}
          body: ${{ github.event.release.body }}
          files: assets/*
          token: ${{ secrets.PUBLIC_REPO_TOKEN }}
